geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
labs(x = "Month of Sale", y = "Dollar Amount of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $937,500") +
theme(legend.position = "bottom", legend.title=element_blank())
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_937.jpg",
plot = numsales_937, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_937.jpg",
plot = dollarsales_937, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
View(bybormonth750_sales)
numsales_750_bor <- ggplot(bybormonth750_sales, aes(x=month, y=numsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $750,000") +
theme(legend.position = "bottom", legend.title=element_blank())
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_750_bor.jpg",
plot = numsales_750_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
numsales_750_bor <- ggplot(bybormonth750_sales, aes(x=month, y=numsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $750,000") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_750_bor.jpg",
plot = numsales_750_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
dollarsales_750_bor <- ggplot(bybormonth750_sales, aes(x=month, y=dollarsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $750,000") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_750_bor.jpg",
plot = dollarsales_750_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
numsales_937_bor <- ggplot(bybormonth937_sales, aes(x=month, y=numsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $937,500") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
dollarsales_937_bor <- ggplot(bybormonth937_sales, aes(x=month, y=dollarsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $937,500") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_937_bor.jpg",
plot = numsales_937_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_937_bor.jpg",
plot = dollarsales_937_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
head(allboroughs_an1)
reg_750k <- lm(sale_price ~ above750k + afterlaw + above750k*afterlaw, data = allboroughs_an1)
summary(reg_750k)
View(allboroughs_an1)
reg_750k <- lm(sale_price ~ above750k_dum + afterlaw + above750k_dum*afterlaw, data = allboroughs_an1)
allboroughs_an1 = mutate(allboroughs_res3, above750k = ifelse(sale_price > 750000, "above 750k", "below 750k"),
above937k = ifelse(sale_price > 937500, "above 937k", "below 937k"),
above750k_dum = ifelse(sale_price > 750000, 1, 0),
above937k_dum = ifelse(sale_price > 937500, 1, 0),
month = format(allboroughs_res3$sale_date,"%Y-%m"),
afterlaw = ifelse(month %in% c("01-2018","02-2018","03-2018"), 1, 0))
reg_750k <- lm(sale_price ~ above750k_dum + afterlaw + above750k_dum*afterlaw, data = allboroughs_an1)
summary(reg_750k)
count(allboroughs_an1,afterlaw) #9,808 = 1, 40,976 = 0
allboroughs_an1 = mutate(allboroughs_res3, above750k = ifelse(sale_price > 750000, "above 750k", "below 750k"),
above937k = ifelse(sale_price > 937500, "above 937k", "below 937k"),
above750k_dum = ifelse(sale_price > 750000, 1, 0),
above937k_dum = ifelse(sale_price > 937500, 1, 0),
month = format(allboroughs_res3$sale_date,"%Y-%m"),
afterlaw = ifelse(month %in% c("2018-01","2018-02","2018-03"), 1, 0))
count(allboroughs_an1,above750k) #19,459 = 1, 31,325 = 0
count(allboroughs_an1,above750k_dum) #19,459 = 1, 31,325 = 0
count(allboroughs_an1,above937k) #13,586 = above 937k, 37,198 = below 937k
count(allboroughs_an1,above937k_dum) #13,586 = 1, 37,198 = 0
count(allboroughs_an1,month) #3,903 in 01-2018, 3,239 in 02-2018, and 2,666 in 03-2018
count(allboroughs_an1,afterlaw) #9,808 = 1, 40,976 = 0
reg_750k <- lm(sale_price ~ above750k_dum + afterlaw + above750k_dum*afterlaw, data = allboroughs_an1)
summary(reg_750k)
library( broom )
write.csv(tidy(reg_750k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_coefs.csv" )
write.csv(glance(reg_750k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_an.csv" )
# above and below 937k
reg_937k <- lm(sale_price ~ above937k_dum + afterlaw + above937k_dum*afterlaw, data = allboroughs_an1)
summary(reg_937k)
write.csv(tidy(reg_937k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_coefs.csv")
write.csv(glance(reg_937k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_an.csv")
## controlling for borough
reg_750k_bor <- lm(sale_price ~ above750k_dum + afterlaw + above750k_dum*afterlaw + borough, data = allboroughs_an1)
summary(reg_reg_750k_bor750k)
summary(reg_750k_bor)
## controlling for borough
reg_937k_bor <- lm(sale_price ~ above937k_dum + afterlaw + above937k_dum*afterlaw + borough, data = allboroughs_an1)
summary(reg_937k_bor)
write.csv(tidy(reg_750k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_bor_coefs.csv")
write.csv(glance(reg_750k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_bor_an.csv")
write.csv(tidy(reg_937k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_bor_coefs.csv")
write.csv(glance(reg_937k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_bor_an.csv")
bymonth750_sales <- allboroughs_an1 %>% group_by(month, above750k) %>% summarise(numsales = n(), dollarsales = mean(sale_price))
bymonth937_sales <- allboroughs_an1 %>% group_by(month, above937k) %>% summarise(numsales = n(), dollarsales = mean(sale_price))
bybormonth750_sales <- allboroughs_an1 %>% group_by(borough, month,above750k) %>% summarise(numsales = n(), dollarsales = mean(sale_price))
bybormonth937_sales <- allboroughs_an1 %>% group_by(borough, month,above937k) %>% summarise(numsales = n(), dollarsales = mean(sale_price))
# plot the number of sales and dollar amount of sales by month
## by above and below 750k
numsales_750 <- ggplot(bymonth750_sales, aes(x=month, y=numsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $750,000") +
theme(legend.position = "bottom", legend.title=element_blank())
dollarsales_750 <- ggplot(bymonth750_sales, aes(x=month, y=dollarsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
labs(x = "Month of Sale", y = "Dollar Amount of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $750,000") +
theme(legend.position = "bottom", legend.title=element_blank())
## by above and below 937k
numsales_937 <- ggplot(bymonth937_sales, aes(x=month, y=numsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $937,500") +
theme(legend.position = "bottom", legend.title=element_blank())
dollarsales_937 <- ggplot(bymonth937_sales, aes(x=month, y=dollarsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
labs(x = "Month of Sale", y = "Dollar Amount of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $937,500") +
theme(legend.position = "bottom", legend.title=element_blank())
# plot the number of sales and dollar amount of sales by month and borough
## by above and below 750k
numsales_750_bor <- ggplot(bybormonth750_sales, aes(x=month, y=numsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $750,000") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
dollarsales_750_bor <- ggplot(bybormonth750_sales, aes(x=month, y=dollarsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $750,000") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
## by above and below 937k
numsales_937_bor <- ggplot(bybormonth937_sales, aes(x=month, y=numsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $937,500") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
dollarsales_937_bor <- ggplot(bybormonth937_sales, aes(x=month, y=dollarsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $937,500") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
# save plots
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_750.jpg",
plot = numsales_750, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_750.jpg",
plot = dollarsales_750, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_937.jpg",
plot = numsales_937, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_937.jpg",
plot = dollarsales_937, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_750_bor.jpg",
plot = numsales_750_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/T./wo Sigma/Research Challenge/dollarsales_750_bor.jpg",
plot = dollarsales_750_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_937_bor.jpg",
plot = numsales_937_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_937_bor.jpg",
plot = dollarsales_937_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
##### run difference-in-differences OLS regressions
# above and below 750k
reg_750k <- lm(sale_price ~ above750k_dum + afterlaw + above750k_dum*afterlaw, data = allboroughs_an1)
summary(reg_750k)
## controlling for borough
reg_750k_bor <- lm(sale_price ~ above750k_dum + afterlaw + above750k_dum*afterlaw + borough, data = allboroughs_an1)
summary(reg_750k_bor)
# above and below 937k
reg_937k <- lm(sale_price ~ above937k_dum + afterlaw + above937k_dum*afterlaw, data = allboroughs_an1)
summary(reg_937k)
## controlling for borough
reg_937k_bor <- lm(sale_price ~ above937k_dum + afterlaw + above937k_dum*afterlaw + borough, data = allboroughs_an1)
summary(reg_937k_bor)
# save regression output
write.csv(tidy(reg_750k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_coefs.csv")
write.csv(glance(reg_750k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_an.csv")
write.csv(tidy(reg_937k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_coefs.csv")
write.csv(glance(reg_937k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_an.csv")
write.csv(tidy(reg_750k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_bor_coefs.csv")
write.csv(glance(reg_750k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_bor_an.csv")
write.csv(tidy(reg_937k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_bor_coefs.csv")
write.csv(glance(reg_937k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_bor_an.csv")
bymonth750_sales <- allboroughs_an1 %>% group_by(month, above750k) %>% summarise(numsales = n(), dollarsales = mean(sale_price))
bymonth937_sales <- allboroughs_an1 %>% group_by(month, above937k) %>% summarise(numsales = n(), dollarsales = mean(sale_price))
bybormonth750_sales <- allboroughs_an1 %>% group_by(borough, month,above750k) %>% summarise(numsales = n(), dollarsales = mean(sale_price))
bybormonth937_sales <- allboroughs_an1 %>% group_by(borough, month,above937k) %>% summarise(numsales = n(), dollarsales = mean(sale_price))
# plot the number of sales and dollar amount of sales by month
## by above and below 750k
numsales_750 <- ggplot(bymonth750_sales, aes(x=month, y=numsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $750,000") +
theme(legend.position = "bottom", legend.title=element_blank())
dollarsales_750 <- ggplot(bymonth750_sales, aes(x=month, y=dollarsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
labs(x = "Month of Sale", y = "Dollar Amount of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $750,000") +
theme(legend.position = "bottom", legend.title=element_blank())
## by above and below 937k
numsales_937 <- ggplot(bymonth937_sales, aes(x=month, y=numsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $937,500") +
theme(legend.position = "bottom", legend.title=element_blank())
dollarsales_937 <- ggplot(bymonth937_sales, aes(x=month, y=dollarsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
labs(x = "Month of Sale", y = "Dollar Amount of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $937,500") +
theme(legend.position = "bottom", legend.title=element_blank())
# plot the number of sales and dollar amount of sales by month and borough
## by above and below 750k
numsales_750_bor <- ggplot(bybormonth750_sales, aes(x=month, y=numsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $750,000") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
dollarsales_750_bor <- ggplot(bybormonth750_sales, aes(x=month, y=dollarsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $750,000") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
## by above and below 937k
numsales_937_bor <- ggplot(bybormonth937_sales, aes(x=month, y=numsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $937,500") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
dollarsales_937_bor <- ggplot(bybormonth937_sales, aes(x=month, y=dollarsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $937,500") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
# save plots
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_750.jpg",
plot = numsales_750, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_750.jpg",
plot = dollarsales_750, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_937.jpg",
plot = numsales_937, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_937.jpg",
plot = dollarsales_937, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_750_bor.jpg",
plot = numsales_750_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/T./wo Sigma/Research Challenge/dollarsales_750_bor.jpg",
plot = dollarsales_750_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_937_bor.jpg",
plot = numsales_937_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_937_bor.jpg",
plot = dollarsales_937_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
##### run difference-in-differences OLS regressions
# above and below 750k
reg_750k <- lm(sale_price ~ above750k_dum + afterlaw + above750k_dum*afterlaw, data = allboroughs_an1)
summary(reg_750k)
## controlling for borough
reg_750k_bor <- lm(sale_price ~ above750k_dum + afterlaw + above750k_dum*afterlaw + borough, data = allboroughs_an1)
summary(reg_750k_bor)
# above and below 937k
reg_937k <- lm(sale_price ~ above937k_dum + afterlaw + above937k_dum*afterlaw, data = allboroughs_an1)
summary(reg_937k)
## controlling for borough
reg_937k_bor <- lm(sale_price ~ above937k_dum + afterlaw + above937k_dum*afterlaw + borough, data = allboroughs_an1)
summary(reg_937k_bor)
# save regression output
write.csv(tidy(reg_750k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_coefs.csv")
write.csv(glance(reg_750k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_an.csv")
write.csv(tidy(reg_937k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_coefs.csv")
write.csv(glance(reg_937k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_an.csv")
write.csv(tidy(reg_750k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_bor_coefs.csv")
write.csv(glance(reg_750k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_bor_an.csv")
write.csv(tidy(reg_937k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_bor_coefs.csv")
write.csv(glance(reg_937k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_bor_an.csv")
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_750_bor.jpg",
plot = dollarsales_750_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
View(allboroughs_res3)
summary(allboroughs_res3)
do.call(rbind, dfapply(allboroughs_res3, favstats))
library(mosaic)
install.packages("mosaic")
library(mosaic)
do.call(rbind, dfapply(allboroughs_res3, favstats))
allboroughs_an1 = mutate(allboroughs_res3, bet1m750k = ifelse(sale_price > 750000 & sale_price < 1000000, "between 1m and 750k", "not between 1m and 750k"),
above750k = ifelse(sale_price > 750000, "above 750k", "below 750k"),
above937k = ifelse(sale_price > 937500, "above 937k", "below 937k"),
bet1m750k_dum = ifelse(sale_price > 750000 & sale_price < 1000000, 1, 0),
above750k_dum = ifelse(sale_price > 750000, 1, 0),
above937k_dum = ifelse(sale_price > 937500, 1, 0),
month = format(allboroughs_res3$sale_date,"%Y-%m"),
afterlaw = ifelse(month %in% c("2018-01","2018-02","2018-03"), 1, 0))
count(allboroughs_an1,bet1m750k) #19,459 = above 750k, 31,325 = below 750k
count(allboroughs_an1,bet1m750k_dum) #7,868 = above 750k and below 1m, 42,916 = not
##### look at summary statistics
# find number of sales and dollar amount of sales
# collapsing data by:
# 1. month and above/below 750k
# 2. month and above/below 937k
# 3. borough, month, and above/below 750k
# 4. borough, month, and above/below 937k
bymonth7501m_sales <- allboroughs_an1 %>% group_by(month, bet1m750k) %>% summarise(numsales = n(), dollarsales = mean(sale_price))
bybormonth7501m_sales <- allboroughs_an1 %>% group_by(borough, month, bet1m750k) %>% summarise(numsales = n(), dollarsales = mean(sale_price))
numsales_7501m <- ggplot(bymonth7501m_sales, aes(x=month, y=numsales, group=bet1m750k)) +
geom_line(aes(color=bet1m750k)) +
geom_point(aes(color=bet1m750k)) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales between $750,000 and $1,000,000 vs Not") +
theme(legend.position = "bottom", legend.title=element_blank())
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_7501m.jpg",
plot = numsales_7501m, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
dollarsales_7501m <- ggplot(bymonth7501m_sales, aes(x=month, y=dollarsales, group=bet1m750k)) +
geom_line(aes(color=bet1m750k)) +
geom_point(aes(color=bet1m750k)) +
labs(x = "Month of Sale", y = "Dollar Amount of Sales", title = "Dollar Amount of Sales by Month for Sales between $750,000 and $1,000,000 vs Not") +
theme(legend.position = "bottom", legend.title=element_blank())
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_7501m.jpg",
plot = dollarsales_7501m, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
numsales_750_bor <- ggplot(bybormonth7501m_sales, aes(x=month, y=numsales, group=bet1m750k)) +
geom_line(aes(color=bet1m750k)) +
geom_point(aes(color=bet1m750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales between $750,000 and $1,000,000 vs Not") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
dollarsales_750_bor <- ggplot(bybormonth7501m_sales, aes(x=month, y=dollarsales, group=bet1m750k)) +
geom_line(aes(color=bet1m750k)) +
geom_point(aes(color=bet1m750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Dollar Amount of Sales by Month for Sales between $750,000 and $1,000,000 vs Not") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
numsales_7501m_bor <- ggplot(bybormonth7501m_sales, aes(x=month, y=numsales, group=bet1m750k)) +
geom_line(aes(color=bet1m750k)) +
geom_point(aes(color=bet1m750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales between $750,000 and $1,000,000 vs Not") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
dollarsales_7501m_bor <- ggplot(bybormonth7501m_sales, aes(x=month, y=dollarsales, group=bet1m750k)) +
geom_line(aes(color=bet1m750k)) +
geom_point(aes(color=bet1m750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Dollar Amount of Sales by Month for Sales between $750,000 and $1,000,000 vs Not") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
numsales_750_bor <- ggplot(bybormonth750_sales, aes(x=month, y=numsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $750,000") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
dollarsales_750_bor <- ggplot(bybormonth750_sales, aes(x=month, y=dollarsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $750,000") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_7501m_bor.jpg",
plot = numsales_7501m_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_7501m_bor.jpg",
plot = dollarsales_7501m_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
reg_750k1m <- lm(sale_price ~ bet1m750k_dum + afterlaw + bet1m750k_dum*afterlaw, data = allboroughs_an1)
summary(reg_750k1m)
## controlling for borough
reg_750k1m_bor <- lm(sale_price ~ bet1m750k_dum + afterlaw + bet1m750k_dum*afterlaw + borough, data = allboroughs_an1)
summary(reg_750k1m_bor)
write.csv(tidy(reg_750k1m), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k1mk_coefs.csv")
write.csv(glance(reg_750k1m), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k1m_an.csv")
write.csv(tidy(reg_750k1m_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k1m_bor_coefs.csv")
write.csv(glance(reg_750k1m_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k1m_bor_an.csv")
# save regression output
write.csv(tidy(reg_750k1m), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k1m_coefs.csv")
bymonth7501m_sales <- allboroughs_an1 %>% group_by(month, bet1m750k) %>% summarise(numsales = n(), dollarsales = median(sale_price))
bymonth750_sales <- allboroughs_an1 %>% group_by(month, above750k) %>% summarise(numsales = n(), dollarsales = median(sale_price))
bymonth937_sales <- allboroughs_an1 %>% group_by(month, above937k) %>% summarise(numsales = n(), dollarsales = median(sale_price))
bybormonth7501m_sales <- allboroughs_an1 %>% group_by(borough, month, bet1m750k) %>% summarise(numsales = n(), dollarsales = median(sale_price))
bybormonth750_sales <- allboroughs_an1 %>% group_by(borough, month, above750k) %>% summarise(numsales = n(), dollarsales = median(sale_price))
bybormonth937_sales <- allboroughs_an1 %>% group_by(borough, month, above937k) %>% summarise(numsales = n(), dollarsales = median(sale_price))
# plot the number of sales and dollar amount of sales by month
## by between 750k and 1m vs. not
numsales_7501m <- ggplot(bymonth7501m_sales, aes(x=month, y=numsales, group=bet1m750k)) +
geom_line(aes(color=bet1m750k)) +
geom_point(aes(color=bet1m750k)) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales between $750,000 and $1,000,000 vs Not") +
theme(legend.position = "bottom", legend.title=element_blank())
dollarsales_7501m <- ggplot(bymonth7501m_sales, aes(x=month, y=dollarsales, group=bet1m750k)) +
geom_line(aes(color=bet1m750k)) +
geom_point(aes(color=bet1m750k)) +
labs(x = "Month of Sale", y = "Median Dollar Amount of Sales", title = "Dollar Amount of Sales by Month for Sales between $750,000 and $1,000,000 vs Not") +
theme(legend.position = "bottom", legend.title=element_blank())
## by above and below 750k
numsales_750 <- ggplot(bymonth750_sales, aes(x=month, y=numsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $750,000") +
theme(legend.position = "bottom", legend.title=element_blank())
dollarsales_750 <- ggplot(bymonth750_sales, aes(x=month, y=dollarsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
labs(x = "Month of Sale", y = "Median Dollar Amount of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $750,000") +
theme(legend.position = "bottom", legend.title=element_blank())
## by above and below 937k
numsales_937 <- ggplot(bymonth937_sales, aes(x=month, y=numsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $937,500") +
theme(legend.position = "bottom", legend.title=element_blank())
dollarsales_937 <- ggplot(bymonth937_sales, aes(x=month, y=dollarsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
labs(x = "Month of Sale", y = "Median Dollar Amount of Sales", title = "Dollar Amount of Sales by Month for Sales Above and Below $937,500") +
theme(legend.position = "bottom", legend.title=element_blank())
# plot the number of sales and dollar amount of sales by month and borough
## by between 750k and 1m vs. not
numsales_7501m_bor <- ggplot(bybormonth7501m_sales, aes(x=month, y=numsales, group=bet1m750k)) +
geom_line(aes(color=bet1m750k)) +
geom_point(aes(color=bet1m750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales between $750,000 and $1,000,000 vs Not") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
dollarsales_7501m_bor <- ggplot(bybormonth7501m_sales, aes(x=month, y=dollarsales, group=bet1m750k)) +
geom_line(aes(color=bet1m750k)) +
geom_point(aes(color=bet1m750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Median Dollar Amount of Sales", title = "Median Dollar Amount of Sales by Month for Sales between $750,000 and $1,000,000 vs Not") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
## by above and below 750k
numsales_750_bor <- ggplot(bybormonth750_sales, aes(x=month, y=numsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $750,000") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
dollarsales_750_bor <- ggplot(bybormonth750_sales, aes(x=month, y=dollarsales, group=above750k)) +
geom_line(aes(color=above750k)) +
geom_point(aes(color=above750k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Median Dollar Amount of Sales", title = "Median Dollar Amount of Sales by Month for Sales Above and Below $750,000") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
## by above and below 937k
numsales_937_bor <- ggplot(bybormonth937_sales, aes(x=month, y=numsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Number of Sales", title = "Number of Sales by Month for Sales Above and Below $937,500") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
dollarsales_937_bor <- ggplot(bybormonth937_sales, aes(x=month, y=dollarsales, group=above937k)) +
geom_line(aes(color=above937k)) +
geom_point(aes(color=above937k)) +
facet_wrap(~ borough) +
labs(x = "Month of Sale", y = "Median Dollar Amount of Sales", title = "Median Dollar Amount of Sales by Month for Sales Above and Below $937,500") +
theme(axis.text.x = element_text(angle=90, hjust=1), legend.position = "bottom", legend.title=element_blank())
# save plots
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_7501m.jpg",
plot = numsales_7501m, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_7501m.jpg",
plot = dollarsales_7501m, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_750.jpg",
plot = numsales_750, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_750.jpg",
plot = dollarsales_750, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_937.jpg",
plot = numsales_937, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_937.jpg",
plot = dollarsales_937, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_7501m_bor.jpg",
plot = numsales_7501m_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_7501m_bor.jpg",
plot = dollarsales_7501m_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_750_bor.jpg",
plot = numsales_750_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_750_bor.jpg",
plot = dollarsales_750_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/numsales_937_bor.jpg",
plot = numsales_937_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
ggsave("/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/dollarsales_937_bor.jpg",
plot = dollarsales_937_bor, device = NULL, path = NULL, scale = 1, width = 8, height = 4)
##### run difference-in-differences OLS regressions
# above and below 750k
reg_750k1m <- lm(sale_price ~ bet1m750k_dum + afterlaw + bet1m750k_dum*afterlaw, data = allboroughs_an1)
summary(reg_750k1m)
## controlling for borough
reg_750k1m_bor <- lm(sale_price ~ bet1m750k_dum + afterlaw + bet1m750k_dum*afterlaw + borough, data = allboroughs_an1)
summary(reg_750k1m_bor)
# above and below 750k
reg_750k <- lm(sale_price ~ above750k_dum + afterlaw + above750k_dum*afterlaw, data = allboroughs_an1)
summary(reg_750k)
## controlling for borough
reg_750k_bor <- lm(sale_price ~ above750k_dum + afterlaw + above750k_dum*afterlaw + borough, data = allboroughs_an1)
summary(reg_750k_bor)
# above and below 937k
reg_937k <- lm(sale_price ~ above937k_dum + afterlaw + above937k_dum*afterlaw, data = allboroughs_an1)
summary(reg_937k)
## controlling for borough
reg_937k_bor <- lm(sale_price ~ above937k_dum + afterlaw + above937k_dum*afterlaw + borough, data = allboroughs_an1)
summary(reg_937k_bor)
# save regression output
write.csv(tidy(reg_750k1m), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k1m_coefs.csv")
write.csv(glance(reg_750k1m), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k1m_an.csv")
write.csv(tidy(reg_750k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_coefs.csv")
write.csv(glance(reg_750k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_an.csv")
write.csv(tidy(reg_937k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_coefs.csv")
write.csv(glance(reg_937k), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_an.csv")
write.csv(tidy(reg_750k1m_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k1m_bor_coefs.csv")
write.csv(glance(reg_750k1m_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k1m_bor_an.csv")
write.csv(tidy(reg_750k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_bor_coefs.csv")
write.csv(glance(reg_750k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_750k_bor_an.csv")
write.csv(tidy(reg_937k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_bor_coefs.csv")
write.csv(glance(reg_937k_bor), "/Users/ChenZhao/Google Drive/Resumes/Two Sigma/Research Challenge/reg_937k_bor_an.csv")
